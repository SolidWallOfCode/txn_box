meta:
  version: "1.0"

config:
  ts:
    remap:
      target: http://example.one
      result: http://example.one
      plugin:
        name: "txn_box.so"
        args:
        - query_replay.yaml
        - config.ts.txn_box
    txn_box:
      with: creq-field.uuid
      select:
      - match: "2"
        do:
          set-remap-query: ""
  blocks:
    base_request: &base_request
      version: "1.1"
      scheme: "http"
      method: "GET"


sessions:
- protocol: [ ipv4, tcp ]
  transactions:
  - client-request:
      <<: *base_request
      url: "http://example.one/?alpha=itchi&bravo=ni&charlie&delta=san"
      headers:
        fields:
        - [ Host, example.one ]
        - [ uuid, 1 ]
    proxy-request:
      <<: *base_request
      url: "http://example.one/?alpha=itchi&bravo=ni&charlie&delta=san"
      headers:
        fields:
        - [ Host, example.one ]
        - [ uuid, 1 ]
    server-response: &std-response
      status: 200
      reason: OK
      content:
        size: 234
      headers:
        fields:
        - [ Content-Type, html/plaintext ]
        - [ Content-Length, 234 ]
        - [ uuid, 1 ]
    proxy-response: &std-response
      status: 200
      reason: OK
      content:
        size: 234
      headers:
        fields:
        - [ Content-Type, html/plaintext ]
        - [ Content-Length, 234 ]
        - [ uuid, 1 ]

  - client-request:
      <<: *base_request
      url: "http://example.one/?alpha=itchi&bravo=ni&charlie&delta=san"
      headers:
        fields:
        - [ Host, example.one ]
        - [ uuid, 2 ]
    proxy-request:
      <<: *base_request
      url: "http://example.one/"
      headers:
        fields:
        - [ Host, example.one ]
        - [ uuid, 2 ]
    server-response:
      <<: *std-response
      headers:
        fields:
        - [ Content-Type, html/plaintext ]
        - [ Content-Length, 234 ]
        - [ uuid, 2 ]
    proxy-response:
      <<: *std-response
      headers:
        fields:
        - [ Content-Type, html/plaintext ]
        - [ Content-Length, 234 ]
        - [ uuid, 2 ]
